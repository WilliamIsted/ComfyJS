"use strict";var A=(e,n,t)=>{if(!n.has(e))throw TypeError("Cannot "+t)};var a=(e,n,t)=>(A(e,n,"read from private field"),t?t.call(e):n.get(e)),c=(e,n,t)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,t)},p=(e,n,t,s)=>(A(e,n,"write to private field"),s?s.call(e,t):n.set(e,t),t);var m=(e,n,t)=>(A(e,n,"access private method"),t);function U(e,n){const t=e.indexOf(" ",n);return{component:e.slice(n+1,t),nextIndex:t+1}}function W(e){let n={raw:e,tags:{},source:null,command:null,parameters:null},t=0;if(e.charAt(0)==="@"){const{component:s,nextIndex:o}=U(e,0);for(const g of s.split(";")){const w=g.split("=");n.tags[w[0]]=w[1]}t=o}if(e.charAt(t)===":"){const{component:s,nextIndex:o}=U(e,t);n.source=s,t=o}if(t<e.length){const s=e.slice(t).trim(),o=s.indexOf(":");n.command=s.slice(0,o<0?void 0:o).trim();const g=e.indexOf(":",t);g>=0&&(n.parameters=e.slice(g+1))}return n}const B=global.WebSocket||require("ws");function J(e,n){return new B(e,n)}var r=(e=>(e.None="none",e.Ping="Ping",e.Pong="Pong",e.Connect="connect",e.Reconnected="reconnect",e.Error="error",e.ChatMode="roomstate",e.Userstate="userstate",e.Join="join",e.Part="part",e.Command="command",e.Chat="message",e.Reply="reply",e.Whisper="whisper",e.Raid="raid",e.Timeout="Timeout",e.Ban="Ban",e.MessageDeleted="MessageDeleted",e.All="all",e))(r||{});function f(e){const n=e.split("!");return n.length>1?n[0]:void 0}function j(e){var n;try{if(e.command){const t=e.command.split(" ");switch(t[0]){case"PING":return{type:"Ping",data:{timestamp:Date.now()}};case"PONG":return{type:"Pong",data:{timestamp:Date.now()}};case"CAP":return null;case"JOIN":return{type:"join",data:{channel:t[1],username:f(e.source)}};case"PART":case"HOSTTARGET":case"USERNOTICE":console.log("TODO IMPLEMENT COMMAND",e);break;case"WHISPER":return console.log(e),console.log("Channel:",t[1],e.parameters),{type:"whisper",data:{...e.tags,channel:t[1],username:f(e.source),message:e.parameters}};case"NOTICE":console.log("NOTICE!!!",e);break;case"CLEARCHAT":if(e.tags["target-user-id"])return e.tags["ban-duration"]?{type:"Timeout",data:{...e.tags,channel:t[1],username:e.parameters,extra:e.tags}}:{type:"Ban",data:{...e.tags,channel:t[1],username:e.parameters,extra:e.tags}};break;case"CLEARMSG":return{type:"MessageDeleted",data:{...e.tags,channel:t[1],username:f(e.source),message:e.parameters,extra:e.tags}};case"PRIVMSG":if((n=e.parameters)!=null&&n.startsWith("!")){const s=e.parameters.split(/ (.*)/),o=s[0].substring(1).toLowerCase(),g=s[1]||"";return{type:"command",data:{channel:t[1],username:f(e.source),command:o,message:g,timestamp:parseInt(e.tags.tmientTs),extra:e.tags}}}else return{type:"message",data:{channel:t[1],username:f(e.source),message:e.parameters,timestamp:parseInt(e.tags["tmi-sent-ts"]),extra:e.tags}};case"GLOBALUSERSTATE":console.log("Global User State");break;case"USERSTATE":switch(e.tags["msg-id"]){case"raid":return{type:"raid",data:{profileImageURL:e.tags["msg-param-profileImageURL"],displayName:e.tags["msg-param-displayName"],viewers:parseInt(e.tags["msg-param-viewerCount"]),channel:t[1],username:f(e.source),timestamp:parseInt(e.tags["tmi-sent-ts"]),extra:e.tags}};default:return{type:"userstate",data:{...e.tags,channel:t[1],username:f(e.source),extra:e.tags}}}case"ROOMSTATE":return{type:"roomstate",data:{emoteOnly:e.tags["emote-only"]?e.tags["emote-only"]!=="0":!1,followersOnly:e.tags["followers-only"]?e.tags["followers-only"]!=="-1":!1,...e.tags,channel:t[1]}};case"RECONNECT":console.log("The Twitch IRC server is about to terminate the connection for maintenance.");break;default:{const s=parseInt(t[0]);if(s>=400)return console.debug(`Error IRC command: ${s}`,e),null;switch(s){case 1:return null;case 2:case 3:case 4:case 353:case 366:case 372:case 375:return null;case 376:return{type:"connect"};default:return console.debug("Unsupported numeric command",s),null}}break}}else console.debug("Commandless IRC message:",e.raw)}catch(t){return console.error("ERROR:",t),{type:"error",data:t}}return console.log(e),null}function H(e){e.send("CAP REQ :twitch.tv/tags twitch.tv/commands")}function V(e,n,t){const s=t?n:`justinfan${Math.floor(Math.random()*99998999+1e3)}`,o=t||"INSTAFLUFF";e.send(`PASS ${o}`),e.send(`NICK ${s}`)}function q(e,n){e.send(`JOIN #${n}`)}function F(e){e.send("PING")}function x(e){e.send("PONG")}function K(e,n,t){e.send(`PRIVMSG #${n} :${t}`)}function Q(e,n,t,s){e.send(`@reply-parent-msg-id=${t} PRIVMSG #${n} :${s}`)}var i,R,I,h,C,y,$,d,u,S,D,P,E,O,v,M,G,N,L,b,k;class Y{constructor(n,t,s,o){c(this,y);c(this,d);c(this,S);c(this,P);c(this,O);c(this,M);c(this,N);c(this,b);c(this,i,void 0);c(this,R,void 0);c(this,I,void 0);c(this,h,void 0);c(this,C,void 0);p(this,C,0),this.handlers={[r.None]:void 0,[r.Ping]:void 0,[r.Connect]:void 0,[r.Reconnected]:void 0,[r.Error]:void 0,[r.ChatMode]:void 0,[r.Userstate]:void 0,[r.Join]:void 0,[r.Part]:void 0,[r.Command]:void 0,[r.Chat]:void 0,[r.Whisper]:void 0,[r.Raid]:void 0,[r.All]:void 0},p(this,R,n),p(this,I,t),this.debug=!!o,(typeof s=="string"||s instanceof String)&&(s=[s]),this.channels=s||[n],m(this,S,D).call(this)}get version(){return"2.0.0"}on(n,t){this.handlers[n]=t}say(n,t){a(this,i)&&a(this,d,u)&&K(a(this,i),t||a(this,y,$),n)}reply(n,t,s){a(this,i)&&a(this,d,u)&&Q(a(this,i),s||a(this,y,$),n,t)}deleteMessage(n,t){a(this,i)&&a(this,d,u)}destroy(){a(this,i)&&a(this,i).readyState!==a(this,i).CLOSED&&a(this,i).close()}}i=new WeakMap,R=new WeakMap,I=new WeakMap,h=new WeakMap,C=new WeakMap,y=new WeakSet,$=function(){return this.channels[0]},d=new WeakSet,u=function(){return a(this,i)&&a(this,i).readyState===a(this,i).OPEN},S=new WeakSet,D=function(){if(a(this,d,u))return;p(this,i,J("wss://irc-ws.chat.twitch.tv:443","irc")),a(this,i).onopen=()=>{m(this,P,E).call(this)},a(this,i).onmessage=t=>{m(this,b,k).call(this,t)},a(this,i).onerror=t=>{m(this,O,v).call(this,t)},a(this,i).onclose=t=>{m(this,M,G).call(this,t)}},P=new WeakSet,E=function(){a(this,i)&&a(this,d,u)&&(H(a(this,i)),V(a(this,i),a(this,R),a(this,I)),q(a(this,i),a(this,y,$)))},O=new WeakSet,v=function(n){console.log("ERROR",n)},M=new WeakSet,G=function(n){console.log("CLOSE",n),a(this,h)&&clearInterval(a(this,h))},N=new WeakSet,L=function(){a(this,i)&&a(this,d,u)&&(p(this,C,Date.now()),F(a(this,i)))},b=new WeakSet,k=function(n){if(!a(this,i)||!a(this,d,u))return;const t=n.data.trim().split(`\r
`);for(const s of t){const o=j(W(s));o&&o.type!==r.None&&(o.type===r.Connect&&(a(this,h)&&clearInterval(a(this,h)),p(this,h,setInterval(()=>{m(this,N,L).call(this)},6e4))),o.type===r.Ping&&x(a(this,i)),o.type===r.Pong&&(o.data.latency=o.data.timestamp-a(this,C)),this.handlers[o.type]&&this.handlers[o.type](o.data),o.type===r.Chat&&this.handlers[r.Reply]&&o.data.extra["reply-parent-msg-id"]&&this.handlers[r.Reply]({...o.data,parentId:o.data.extra["reply-parent-msg-id"],parentUserId:o.data.extra["reply-parent-user-id"],parentUser:o.data.extra["reply-parent-user-login"],parentMessage:o.data.extra["reply-parent-msg-body"],parentDisplayName:o.data.extra["reply-parent-display-name"]}),this.handlers[r.All]&&this.handlers[r.All](o.data))}};const _="oauth:bmifibqgh2tcmvx7i5a41bgbks3pt5",z="instafluff",X=_,l=new Y(z,X);l.on(r.Connect,()=>{console.log("Connected to Twitch Chat!")});l.on(r.Error,e=>{console.error("ERROR:",e)});l.on(r.ChatMode,e=>{console.error("ChatMode:",e)});l.on(r.Command,e=>{console.log(`${e.channel} - ${e.username} used command !${e.command} ${e.message}`,e),e.command==="reply"&&(console.log(e),l.reply(e.extra.id,"Hello!")),e.command==="delete"&&(console.log(e),l.deleteMessage(e.extra.id))});l.on(r.Chat,e=>{console.log(`${e.channel} - ${e.username} : ${e.message}`,e)});l.on(r.Chat,e=>{console.log(`${e.channel} - ${e.username} : ${e.message}`,e)});l.on(r.Whisper,e=>{console.log(`${e.channel} - ${e.username} : ${e.message}`)});l.on(r.Raid,e=>{console.log(`${e.channel} - ${e.username} has raided!`,e)});l.on(r.Reply,e=>{console.log(`${e.channel} - ${e.username} replied to ${e.parentDisplayName} : ${e.message}`,e),setTimeout(()=>{l.reply(e.extra.id,"Yes, I am replying to your message")},3e3)});l.on(r.Pong,e=>{console.log(`PONG: ${e.latency} ms`)});l.on(r.MessageDeleted,e=>{console.log(`Message Deleted in ${e.channel}`,e)});l.on(r.Ban,e=>{console.log(`User Banned in ${e.channel}`,e)});l.on(r.Timeout,e=>{console.log(`User Timed Out in ${e.channel}`,e)});
//# sourceMappingURL=comfy.min.js.map
