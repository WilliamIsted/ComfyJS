"use strict";var G=(e,n,t)=>{if(!n.has(e))throw TypeError("Cannot "+t)};var r=(e,n,t)=>(G(e,n,"read from private field"),t?t.call(e):n.get(e)),l=(e,n,t)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,t)},C=(e,n,t,a)=>(G(e,n,"write to private field"),a?a.call(e,t):n.set(e,t),t);var p=(e,n,t)=>(G(e,n,"access private method"),t);function w(e,n){const t=e.indexOf(" ",n);return{component:e.slice(n+1,t),nextIndex:t+1}}function W(e){let n={raw:e,tags:{},source:null,command:null,parameters:null},t=0;if(e.charAt(0)==="@"){const{component:a,nextIndex:o}=w(e,0);for(const m of a.split(";")){const A=m.split("=");n.tags[A[0]]=A[1]}t=o}if(e.charAt(t)===":"){const{component:a,nextIndex:o}=w(e,t);n.source=a,t=o}if(t<e.length){const a=e.slice(t).trim(),o=a.indexOf(":");n.command=a.slice(0,o<0?void 0:o).trim();const m=e.indexOf(":",t);m>=0&&(n.parameters=e.slice(m+1))}return n}const J=global.WebSocket||require("ws");function V(e,n){return new J(e,n)}var s=(e=>(e.None="none",e.Ping="Ping",e.Connect="connect",e.Reconnected="reconnect",e.Error="error",e.ChatMode="roomstate",e.Userstate="userstate",e.Join="join",e.Part="part",e.Command="command",e.Chat="message",e.Reply="reply",e.Whisper="whisper",e.Raid="raid",e.All="all",e))(s||{});function f(e){const n=e.split("!");return n.length>1?n[0]:void 0}function j(e){var n;try{if(e.command){const t=e.command.split(" ");switch(t[0]){case"PING":return console.debug("PING"),{type:"Ping",data:{timestamp:Date.now()}};break;case"PONG":console.debug("PONG");break;case"CAP":return null;case"JOIN":return{type:"join",data:{channel:t[1],username:f(e.source)}};case"PART":case"NOTICE":case"CLEARCHAT":case"CLEARMSG":case"HOSTTARGET":case"USERNOTICE":case"WHISPER":return console.log(e),console.log("Channel:",t[1],e.parameters),{type:"whisper",data:{...e.tags,channel:t[1],username:f(e.source),message:e.parameters}};break;case"PRIVMSG":if((n=e.parameters)!=null&&n.startsWith("!")){const a=e.parameters.split(/ (.*)/),o=a[0].substring(1).toLowerCase(),m=a[1]||"";return{type:"command",data:{channel:t[1],username:f(e.source),command:o,message:m,timestamp:parseInt(e.tags.tmientTs),extra:e.tags}}}else return{type:"message",data:{channel:t[1],username:f(e.source),message:e.parameters,timestamp:parseInt(e.tags["tmi-sent-ts"]),extra:e.tags}};case"GLOBALUSERSTATE":console.log("Global User State");break;case"USERSTATE":switch(e.tags["msg-id"]){case"raid":return{type:"raid",data:{profileImageURL:e.tags["msg-param-profileImageURL"],displayName:e.tags["msg-param-displayName"],viewers:parseInt(e.tags["msg-param-viewerCount"]),channel:t[1],username:f(e.source),timestamp:parseInt(e.tags["tmi-sent-ts"]),extra:e.tags}};default:return{type:"userstate",data:{...e.tags,channel:t[1],username:f(e.source),extra:e.tags}}}case"ROOMSTATE":return{type:"roomstate",data:{emoteOnly:e.tags["emote-only"]?e.tags["emote-only"]!=="0":!1,followersOnly:e.tags["followers-only"]?e.tags["followers-only"]!=="-1":!1,...e.tags,channel:t[1]}};case"RECONNECT":console.log("The Twitch IRC server is about to terminate the connection for maintenance.");break;default:{const a=parseInt(t[0]);if(a>=400)return console.debug(`Error IRC command: ${a}`,e),null;switch(a){case 1:return null;case 2:case 3:case 4:case 353:case 366:case 372:case 375:return null;case 376:return{type:"connect"};default:return console.debug("Unsupported numeric command",a),null}}break}}else console.debug("Commandless IRC message:",e.raw)}catch(t){return console.error("ERROR:",t),{type:"error",data:t}}return console.log(e),null}function D(e){e.send("CAP REQ :twitch.tv/tags twitch.tv/commands")}function H(e,n,t){const a=t?n:`justinfan${Math.floor(Math.random()*99998999+1e3)}`,o=t||"INSTAFLUFF";e.send(`PASS ${o}`),e.send(`NICK ${a}`)}function q(e,n){e.send(`JOIN #${n}`)}function x(e){e.send("PING")}function F(e){e.send("PONG")}function B(e,n,t){e.send(`PRIVMSG #${n} :${t}`)}function K(e,n,t,a){console.debug(`@reply-parent-msg-id=${t} PRIVMSG #${n} :${a}`),e.send(`@reply-parent-msg-id=${t} PRIVMSG #${n} :${a}`)}var i,y,I,u,g,R,d,h,S,M,$,v,N,E,P,U,b,k,O,L;class Q{constructor(n,t,a,o){l(this,g);l(this,d);l(this,S);l(this,$);l(this,N);l(this,P);l(this,b);l(this,O);l(this,i,void 0);l(this,y,void 0);l(this,I,void 0);l(this,u,void 0);this.handlers={[s.None]:void 0,[s.Ping]:void 0,[s.Connect]:void 0,[s.Reconnected]:void 0,[s.Error]:void 0,[s.ChatMode]:void 0,[s.Userstate]:void 0,[s.Join]:void 0,[s.Part]:void 0,[s.Command]:void 0,[s.Chat]:void 0,[s.Whisper]:void 0,[s.Raid]:void 0,[s.All]:void 0},C(this,y,n),C(this,I,t),this.debug=!!o,(typeof a=="string"||a instanceof String)&&(a=[a]),this.channels=a||[n],p(this,S,M).call(this)}get version(){return"2.0.0"}on(n,t){this.handlers[n]=t}say(n,t){r(this,i)&&r(this,d,h)&&B(r(this,i),t||r(this,g,R),n)}reply(n,t,a){r(this,i)&&r(this,d,h)&&K(r(this,i),a||r(this,g,R),n,t)}destroy(){r(this,i)&&r(this,i).readyState!==r(this,i).CLOSED&&r(this,i).close()}}i=new WeakMap,y=new WeakMap,I=new WeakMap,u=new WeakMap,g=new WeakSet,R=function(){return this.channels[0]},d=new WeakSet,h=function(){return r(this,i)&&r(this,i).readyState===r(this,i).OPEN},S=new WeakSet,M=function(){if(r(this,d,h))return;C(this,i,V("wss://irc-ws.chat.twitch.tv:443","irc")),r(this,i).onopen=()=>{p(this,$,v).call(this)},r(this,i).onmessage=t=>{p(this,O,L).call(this,t)},r(this,i).onerror=t=>{p(this,N,E).call(this,t)},r(this,i).onclose=t=>{p(this,P,U).call(this,t)}},$=new WeakSet,v=function(){r(this,i)&&r(this,d,h)&&(D(r(this,i)),H(r(this,i),r(this,y),r(this,I)),q(r(this,i),r(this,g,R)))},N=new WeakSet,E=function(n){console.log("ERROR",n)},P=new WeakSet,U=function(n){console.log("CLOSE",n),r(this,u)&&clearInterval(r(this,u))},b=new WeakSet,k=function(){console.log("ping start",r(this,d,h)),r(this,i)&&r(this,d,h)&&(console.log("pinging"),x(r(this,i)),console.log("PINGINGINGINGINGINGNG"))},O=new WeakSet,L=function(n){if(!r(this,i)||!r(this,d,h))return;const t=n.data.trim().split(`\r
`);for(const a of t){const o=j(W(a));o&&o.type!==s.None&&(this.handlers[o.type]&&this.handlers[o.type](o.data),o.type===s.Chat&&this.handlers[s.Reply]&&o.data.extra["reply-parent-msg-id"]&&this.handlers[s.Reply]({...o.data,parentId:o.data.extra["reply-parent-msg-id"],parentUserId:o.data.extra["reply-parent-user-id"],parentUser:o.data.extra["reply-parent-user-login"],parentMessage:o.data.extra["reply-parent-msg-body"],parentDisplayName:o.data.extra["reply-parent-display-name"]}),this.handlers[s.All]&&this.handlers[s.All](o.data),o.type===s.Connect&&(r(this,u)&&clearInterval(r(this,u)),console.log("setting ping timer"),C(this,u,setInterval(()=>{p(this,b,k).call(this)},6e4))),o.type===s.Ping&&F(r(this,i)))}};const Y="oauth:bmifibqgh2tcmvx7i5a41bgbks3pt5",_="instafluff",z=Y,c=new Q(_,z);c.on(s.Connect,()=>{console.log("Connected to Twitch Chat!")});c.on(s.Error,e=>{console.error("ERROR:",e)});c.on(s.ChatMode,e=>{console.error("ChatMode:",e)});c.on(s.Command,e=>{console.log(`${e.channel} - ${e.username} used command !${e.command} ${e.message}`,e),e.command==="reply"&&(console.log(e),c.reply(e.extra.id,"Hello!"))});c.on(s.Chat,e=>{console.log(`${e.channel} - ${e.username} : ${e.message}`,e)});c.on(s.Chat,e=>{console.log(`${e.channel} - ${e.username} : ${e.message}`,e)});c.on(s.Whisper,e=>{console.log(`${e.channel} - ${e.username} : ${e.message}`)});c.on(s.Raid,e=>{console.log(`${e.channel} - ${e.username} has raided!`,e)});c.on(s.Reply,e=>{console.log(`${e.channel} - ${e.username} replied to ${e.parentDisplayName} : ${e.message}`,e),setTimeout(()=>{c.reply(e.extra.id,"Yes, I am replying to your message")},3e3)});
//# sourceMappingURL=comfy.min.js.map
