"use strict";var T=(a,r,s)=>{if(!r.has(a))throw TypeError("Cannot "+s)};var n=(a,r,s)=>(T(a,r,"read from private field"),s?s.call(a):r.get(a)),c=(a,r,s)=>{if(r.has(a))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(a):r.set(a,s)},S=(a,r,s,o)=>(T(a,r,"write to private field"),o?o.call(a,s):r.set(a,s),s);var M=(a,r,s)=>(T(a,r,"access private method"),s);function Ea(a){return!a||typeof a!="string"||!a.includes("\\")?a:a.replace(/\\(.)/g,(r,s)=>{switch(s){case"\\":return"\\";case":":return";";case"s":return" ";case"r":return"\r";case"n":return`
`;default:return s}})}function Z(a,r){const s=a.indexOf(" ",r);return{component:a.slice(r+1,s),nextIndex:s+1}}function Oa(a){const r={raw:a,tags:{},source:null,command:null,parameters:null};let s=0;if(a[0]==="@"){const{component:o,nextIndex:t}=Z(a,0);for(const e of o.split(";")){const N=e.indexOf("="),g=e.substring(0,N),l=e.substring(N+1);switch(g){case"emote-sets":case"ban-duration":case"bits":case"id":case"room-id":case"color":case"login":r.tags[g]=l;break;default:r.tags[g]=Ea(l);break}}s=t}if(a[s]===":"){const{component:o,nextIndex:t}=Z(a,s);r.source=o,s=t}if(s<a.length){const o=a.slice(s).trim(),t=o.indexOf(":");r.command=o.slice(0,t<0?void 0:t).trim();const e=a.indexOf(":",s);e>=0&&(r.parameters=a.slice(e+1))}return r}const ka=globalThis.WebSocket||require("ws");function Ua(a,r){return new ka(a,r)}var d=(a=>(a.None="none",a.Ping="Ping",a.Pong="Pong",a.Connect="connect",a.Reconnect="reconnect",a.Error="error",a.Warning="Warning",a.ChatMode="chatmode",a.ClearChat="ClearChat",a.RoomState="roomstate",a.GlobalUserState="globaluserstate",a.UserState="userstate",a.Notice="notice",a.Join="join",a.Leave="leave",a.Command="command",a.Chat="message",a.Reply="reply",a.Whisper="whisper",a.Announcement="announcement",a.Cheer="Cheer",a.Subscribe="sub",a.Resubscribe="resub",a.SubGift="subgift",a.MysterySubGift="submysterygift",a.SubGiftContinue="subgiftcontinue",a.Raid="raid",a.Unraid="unraid",a.Timeout="Timeout",a.Ban="Ban",a.MessageDeleted="MessageDeleted",a.ViewerMilestone="ViewerMilestone",a.All="all",a))(d||{});const I={"":"Normal",admin:"Admin",global_mod:"Global Mod",staff:"Staff",mod:"Moderator"};function U(a){if(!a)return;const r=a.indexOf("!");return r!==-1?a.slice(0,r):void 0}function m(a){if(!a)return;const r=a.split(","),s={};for(const o of r){const t=o.indexOf("/");s[o.slice(0,t)]=o.slice(t+1)}return s}function z(a){if(!a)return;const r=a.split(","),s={};for(const o of r){const t=o.indexOf(":"),e=o.indexOf("."),N=o.slice(t+1,e),g=parseInt(o.slice(e+1));switch(N){case"A":s.aggressive=Math.max(s.aggressive||0,g);break;case"I":s["identity-hate"]=Math.max(s["identity-hate"]||0,g);break;case"P":s.profane=Math.max(s.profane||0,g);break;case"S":s.sexual=Math.max(s.sexual||0,g);break}}return s}function wa(a,r){var K,Q,X;const s=(K=a.parameters)==null?void 0:K.startsWith("ACTION"),o=s?(X=(Q=a.parameters)==null?void 0:Q.match(/^\u0001ACTION ([^\u0001]+)\u0001$/))==null?void 0:X[1]:a.parameters,t=a.tags,e=t.id,N=t["room-id"],g=t["user-id"],l=U(a.source),v=t["display-name"]||t.login||l,oa=I[t["user-type"]],ia=t["badge-info"]?m(t["badge-info"]):void 0,C=t.badges?m(t.badges):void 0,ua=t.color||void 0,da=t.emotes,J=t.flags,la=void 0,ga=l===r,pa=t.mod==="1",ma=t.subscriber==="1",ca=t.turbo==="1",fa=C?!!C.vip:!1,ba=C?!!C.premium:!1,ha=C?!!C.partner:!1,Ia=C?!!C["game-developer"]:!1,ya=C?!!C.founder:!1,Ca=parseInt(t["tmi-sent-ts"]),H=t["emote-only"]==="1",Sa=t["msg-id"]==="highlighted-message",Na=t["msg-id"]==="skip-subs-mode-message",_=t["custom-reward-id"]||null,Ma=t["first-msg"]==="1",Pa=t["returning-chatter"]==="1",q={channel:r,channelId:N,displayName:v,username:l,userId:g,userType:oa,id:e,messageType:s?"action":"chat",messageEmotes:da,messageFlags:J,contentFlags:la,isEmoteOnly:H,userColor:ua,userBadgeInfo:ia,userBadges:C,customRewardId:_,flags:{broadcaster:ga,mod:pa,founder:ya,subscriber:ma,vip:fa,partner:ha,gameDeveloper:Ia,turbo:ca,prime:ba,highlighted:Sa,skipSubsMode:Na,customReward:!!_,emoteOnly:H,firstMessage:Ma,returningChatter:Pa},timestamp:Ca,extra:{...t,flags:J||null}};if(t.bits)return{type:"Cheer",data:{...q,message:a.parameters,bits:parseInt(t.bits)}};{const k=o==null?void 0:o.startsWith("!"),Y=k?o.split(/ (.*)/):null,Ra=k?Y[0].substring(1).toLowerCase():null,va=k?Y[1]||"":null;return{type:k?"command":"message",data:{...q,message:k?va:o,command:Ra}}}}function Ga(a){var r,s,o,t,e,N;try{if(a.command){const g=a.command.split(" "),l=g.length>1?g[1].substring(1):void 0;switch(g[0]){case"PING":return{type:"Ping"};case"PONG":return{type:"Pong"};case"CAP":return null;case"JOIN":return{type:"join",data:{channel:l,username:U(a.source)}};case"PART":return{type:"leave",data:{channel:l,username:U(a.source)}};case"ROOMSTATE":return{type:"roomstate",data:{...a.tags["broadcaster-lang"]&&{broadcasterLanguage:a.tags["broadcaster-lang"]},...a.tags["emote-only"]&&{emoteOnly:a.tags["emote-only"]!=="0"},...a.tags["followers-only"]&&{followersOnly:a.tags["followers-only"]!=="-1"},...a.tags["subs-only"]&&{subscribersOnly:a.tags["subs-only"]!=="0"},...a.tags.r9k&&{r9k:a.tags.r9k!=="0"},...a.tags.rituals&&{rituals:a.tags.rituals!=="0"},...a.tags.slow&&{slow:a.tags.slow!=="0"},channel:l,channelId:a.tags["room-id"]}};case"GLOBALUSERSTATE":return{type:"globaluserstate",data:{displayName:a.tags["display-name"],userId:a.tags["user-id"],userType:I[a.tags["user-type"]],color:a.tags.color,badges:a.tags.badges,badgeInfo:a.tags["badge-info"],emoteSets:a.tags["emote-sets"],extra:a.tags}};case"USERSTATE":return{type:"userstate",data:{channel:l,displayName:a.tags["display-name"],userId:a.tags["user-id"],userType:I[a.tags["user-type"]],color:a.tags.color,badgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,badges:a.tags.badges?m(a.tags.badges):void 0,emoteSets:a.tags["emote-sets"],...a.tags.id&&{id:a.tags.id},mod:a.tags.mod==="1",subscriber:a.tags.subscriber==="1",turbo:a.tags.turbo==="1",extra:a.tags}};case"HOSTTARGET":break;case"USERNOTICE":switch(a.tags["msg-id"]){case"announcement":return{type:"announcement",data:{displayName:a.tags["display-name"]||a.tags.login,channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],message:a.parameters,messageType:a.tags["msg-id"],messageEmotes:a.tags.emotes,timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"sub":return{type:"sub",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,months:parseInt(a.tags["msg-param-months"]),multiMonthDuration:parseInt(a.tags["msg-param-multimonth-duration"]),multiMonthTenure:parseInt(a.tags["msg-param-multimonth-tenure"]),shouldShareStreak:a.tags["msg-param-should-share-streak"]==="1",subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],wasGifted:a.tags["msg-param-was-gifted"]==="true",...a.tags["msg-param-goal-contribution-type"]&&{goalContributionType:a.tags["msg-param-goal-contribution-type"]},...a.tags["msg-param-goal-current-contributions"]&&{goalCurrentContributions:parseInt(a.tags["msg-param-goal-current-contributions"])},...a.tags["msg-param-goal-description"]&&{goalDescription:a.tags["msg-param-goal-description"]},...a.tags["msg-param-goal-target-contributions"]&&{goalTargetContributions:parseInt(a.tags["msg-param-goal-target-contributions"])},...a.tags["msg-param-goal-user-contributions"]&&{goalUserContributions:parseInt(a.tags["msg-param-goal-user-contributions"])},channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,userColor:a.tags.color||void 0,message:a.parameters,messageType:a.tags["msg-id"],messageEmotes:a.tags.emotes,messageFlags:a.tags.flags,contentFlags:z(a.tags.flags),timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"resub":return{type:"resub",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,cumulativeMonths:parseInt(a.tags["msg-param-cumulative-months"]),months:parseInt(a.tags["msg-param-months"]),multiMonthDuration:parseInt(a.tags["msg-param-multimonth-duration"]),multiMonthTenure:parseInt(a.tags["msg-param-multimonth-tenure"]),...a.tags["msg-param-streak-months"]&&{streakMonths:parseInt(a.tags["msg-param-streak-months"])},shouldShareStreak:a.tags["msg-param-should-share-streak"]==="1",subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],wasGifted:a.tags["msg-param-was-gifted"]==="true",channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,userColor:a.tags.color||void 0,message:a.parameters,messageType:a.tags["msg-id"],messageEmotes:a.tags.emotes,messageFlags:a.tags.flags,contentFlags:z(a.tags.flags),timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"submysterygift":return{type:"submysterygift",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,giftCount:parseInt(a.tags["msg-param-mass-gift-count"]),senderCount:parseInt(a.tags["msg-param-sender-count"]||"0"),subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],...a.tags["msg-param-goal-contribution-type"]&&{goalContributionType:a.tags["msg-param-goal-contribution-type"]},...a.tags["msg-param-goal-current-contributions"]&&{goalCurrentContributions:parseInt(a.tags["msg-param-goal-current-contributions"])},...a.tags["msg-param-goal-description"]&&{goalDescription:a.tags["msg-param-goal-description"]},...a.tags["msg-param-goal-target-contributions"]&&{goalTargetContributions:parseInt(a.tags["msg-param-goal-target-contributions"])},...a.tags["msg-param-goal-user-contributions"]&&{goalUserContributions:parseInt(a.tags["msg-param-goal-user-contributions"])},channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"subgift":return{type:"subgift",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,recipientDisplayName:a.tags["msg-param-recipient-display-name"],recipientId:a.tags["msg-param-recipient-id"],recipientUsername:a.tags["msg-param-recipient-user-name"],months:parseInt(a.tags["msg-param-months"]),giftMonths:parseInt(a.tags["msg-param-gift-months"]),senderCount:parseInt(a.tags["msg-param-sender-count"]||"0"),subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],...a.tags["msg-param-goal-contribution-type"]&&{goalContributionType:a.tags["msg-param-goal-contribution-type"]},...a.tags["msg-param-goal-current-contributions"]&&{goalCurrentContributions:parseInt(a.tags["msg-param-goal-current-contributions"])},...a.tags["msg-param-goal-description"]&&{goalDescription:a.tags["msg-param-goal-description"]},...a.tags["msg-param-goal-target-contributions"]&&{goalTargetContributions:parseInt(a.tags["msg-param-goal-target-contributions"])},...a.tags["msg-param-goal-user-contributions"]&&{goalUserContributions:parseInt(a.tags["msg-param-goal-user-contributions"])},channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"giftpaidupgrade":return{type:"subgiftcontinue",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,gifterDisplayName:a.tags["msg-param-sender-name"]||a.tags["msg-param-sender-login"],gifterUsername:a.tags["msg-param-sender-login"],channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"raid":return{type:"raid",data:{id:a.tags.id,profileImageURL:a.tags["msg-param-profileImageURL"],displayName:a.tags["msg-param-displayName"]||a.tags["display-name"]||a.tags["msg-param-login"]||a.tags.login,viewers:parseInt(a.tags["msg-param-viewerCount"]),channel:l,channelId:a.tags["room-id"],username:a.tags["msg-param-login"]||a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"unraid":return console.log(a),{type:"unraid",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,channel:a.tags.login,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"viewermilestone":return console.log(a),{type:"ViewerMilestone",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],messageType:a.tags["msg-id"],category:a.tags["msg-param-category"],milestoneId:a.tags["msg-param-id"],milestoneValue:parseInt(a.tags["msg-param-value"]),timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};default:console.log("TODO IMPLEMENT COMMAND",a);break}break;case"WHISPER":return{type:"whisper",data:{displayName:a.tags["display-name"]||a.tags.login||U(a.source),username:U(a.source),userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userColor:a.tags.color||void 0,userBadgeInfo:a.tags["badge-info"]?m(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?m(a.tags.badges):void 0,messageEmotes:a.tags.emotes,turbo:a.tags.turbo==="1",threadId:a.tags["thread-id"],messageId:a.tags["message-id"],message:a.parameters,messageType:"whisper",extra:a.tags}};case"NOTICE":return(r=a.parameters)!=null&&r.includes("Login unsuccessful")||(s=a.parameters)!=null&&s.includes("Login authentication failed")||(o=a.parameters)!=null&&o.includes("Error logging in")||(t=a.parameters)!=null&&t.includes("Improperly formatted auth")||(e=a.parameters)!=null&&e.includes("Invalid NICK")||(N=a.parameters)!=null&&N.includes("Invalid CAP REQ")?{type:"error",data:{channel:l,message:a.parameters}}:{type:"notice",data:{channel:l,msgId:a.tags["msg-id"],message:a.parameters}};case"CLEARCHAT":return a.tags["target-user-id"]?a.tags["ban-duration"]?{type:"Timeout",data:{channel:l,channelId:a.tags["room-id"],duration:parseInt(a.tags["ban-duration"]),username:a.parameters,userId:a.tags["target-user-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}}:{type:"Ban",data:{channel:l,channelId:a.tags["room-id"],username:a.parameters,userId:a.tags["target-user-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}}:{type:"ClearChat",data:{channel:l,channelId:a.tags["room-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"CLEARMSG":return{type:"MessageDeleted",data:{channel:l,channelId:a.tags["room-id"],displayName:a.tags["display-name"]||a.tags.login,username:a.tags.login,id:a.tags["target-msg-id"],message:a.parameters,timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"PRIVMSG":return wa(a,l);case"RECONNECT":console.log("The Twitch IRC server is about to terminate the connection for maintenance.");break;default:{const v=parseInt(g[0]);if(v>=400)return console.debug(`Error IRC command: ${v}`,a),null;switch(v){case 1:return null;case 2:case 3:case 4:case 353:case 366:case 372:case 375:return null;case 376:return{type:"connect",data:{username:g[1]}};default:return console.debug("Unsupported numeric command",v),null}}break}}else console.debug("Unprocessed IRC message:",a.raw)}catch(g){return console.error(g),{type:"Warning",data:g}}return console.log(a),null}function Ba(a){a.send("CAP REQ :twitch.tv/tags twitch.tv/commands")}function Aa(a,r,s){const o=s?r:`justinfan${Math.floor(Math.random()*99998999+1e3)}`,t=s||"INSTAFLUFF";a.send(`PASS ${t}`),a.send(`NICK ${o}`)}function x(a,r){if(Array.isArray(r)){const s=r.map(o=>`#${o}`).join(",");a.send(`JOIN ${s}`)}else a.send(`JOIN #${r}`)}function Da(a,r){a.send(`PART #${r}`)}function La(a){a.send("PING")}function Wa(a){a.send("PONG")}function Fa(a,r,s){a.send(`PRIVMSG #${r} :${s}`)}function $a(a,r,s,o){a.send(`@reply-parent-msg-id=${s} PRIVMSG #${r} :${o}`)}var u,P,w,R,E,O,G,V,h,y,A,aa,D,ta,L,ra,W,sa,F,ea,$,na,B,j;class Ta{constructor(r,s,o,t){c(this,G);c(this,h);c(this,A);c(this,D);c(this,L);c(this,W);c(this,F);c(this,$);c(this,B);c(this,u,void 0);c(this,P,void 0);c(this,w,void 0);c(this,R,void 0);c(this,E,void 0);c(this,O,void 0);S(this,E,0),S(this,O,-1),this.reconnects=0,this.chatModes={},this.handlers={},S(this,P,r),S(this,w,s),this.debug=!!t,(typeof o=="string"||o instanceof String)&&(o=[o]),this.channels=o||[r],M(this,A,aa).call(this)}get version(){return"2.0.0"}get latency(){return n(this,O)}get ws(){return n(this,u)}on(r,s){this.handlers[r]=s}say(r,s){n(this,u)&&n(this,h,y)&&Fa(n(this,u),s||n(this,G,V),r)}reply(r,s,o){n(this,u)&&n(this,h,y)&&$a(n(this,u),o||n(this,G,V),r,s)}join(r){n(this,u)&&n(this,h,y)&&x(n(this,u),r)}leave(r){n(this,u)&&n(this,h,y)&&Da(n(this,u),r)}deleteMessage(r,s){n(this,u)&&n(this,h,y)}simulateIRCMessage(r){n(this,u)&&n(this,h,y)&&M(this,B,j).call(this,{data:r})}destroy(){n(this,u)&&n(this,u).readyState!==n(this,u).CLOSED&&n(this,u).close()}}u=new WeakMap,P=new WeakMap,w=new WeakMap,R=new WeakMap,E=new WeakMap,O=new WeakMap,G=new WeakSet,V=function(){return this.channels[0]},h=new WeakSet,y=function(){return!!(n(this,u)&&n(this,u).readyState===n(this,u).OPEN)},A=new WeakSet,aa=function(){if(n(this,h,y))return;S(this,u,Ua("wss://irc-ws.chat.twitch.tv:443","irc")),n(this,u).onopen=()=>{M(this,D,ta).call(this)},n(this,u).onmessage=s=>{M(this,B,j).call(this,s)},n(this,u).onerror=s=>{M(this,L,ra).call(this,s)},n(this,u).onclose=s=>{M(this,W,sa).call(this,s)}},D=new WeakSet,ta=function(){n(this,u)&&n(this,h,y)&&(Ba(n(this,u)),Aa(n(this,u),n(this,P),n(this,w)))},L=new WeakSet,ra=function(r){console.error("ERROR",r)},W=new WeakSet,sa=function(r){console.info("CLOSE",r),n(this,R)&&clearInterval(n(this,R))},F=new WeakSet,ea=function(){n(this,u)&&n(this,h,y)&&(S(this,E,Date.now()),La(n(this,u)))},$=new WeakSet,na=function(r){if(n(this,u)&&n(this,h,y))switch(r.type){case d.Connect:S(this,P,r.data.username),n(this,R)&&clearInterval(n(this,R)),S(this,R,setInterval(()=>{M(this,F,ea).call(this)},6e4));const s=new URL(n(this,u).url);r.data.address=s.host,r.data.port=s.protocol==="wss:"?443:80,r.data.isFirstConnect=this.reconnects===0,x(n(this,u),this.channels);break;case d.Ping:Wa(n(this,u));break;case d.Pong:r.data=r.data||{},S(this,O,r.data.latency=Date.now()-n(this,E));break;case d.RoomState:this.chatModes[r.data.channel]={...this.chatModes[r.data.channel],...r.data},this.handlers[d.ChatMode]&&this.handlers[d.ChatMode](this.chatModes[r.data.channel]);break;case d.Error:n(this,u).close();break;case d.Whisper:r.data.self=r.data.username===n(this,P);break;case d.Chat:r.data.self=r.data.username===n(this,P),this.handlers[d.Reply]&&r.data.extra["reply-parent-msg-id"]&&this.handlers[d.Reply]({...r.data,parentId:r.data.extra["reply-parent-msg-id"],parentUserId:r.data.extra["reply-parent-user-id"],parentUser:r.data.extra["reply-parent-user-login"],parentMessage:r.data.extra["reply-parent-msg-body"],parentDisplayName:r.data.extra["reply-parent-display-name"]||r.data.extra["reply-parent-user-login"]});break}},B=new WeakSet,j=function(r){if(!n(this,u)||!n(this,h,y))return;const s=r.data.trim().split(`\r
`);for(const o of s){const t=Ga(Oa(o));t&&t.type!==d.None&&(M(this,$,na).call(this,t),this.handlers[t.type]&&this.handlers[t.type](t.data),this.handlers[d.All]&&this.handlers[d.All]({event:t.type,...t.data}))}};let i;function f(a){if(a){const r=a.split("/"),s={};for(const o of r){const[t,e]=o.split(":");s[t]=e.split(",")}return s}return null}function b(a){const r={};for(const s in a.extra)a.extra[s]===""?r[s]=null:a.extra[s]==="1"?r[s]=!0:a.extra[s]==="0"?r[s]=!1:r[s]=a.extra[s];return r["badge-info-raw"]=r["badge-info"],r["badge-info"]=a.userBadgeInfo||null,r["badges-raw"]=r.badges,r.badges=a.userBadges||null,r["emotes-raw"]=r.emotes,r.emotes=f(a.messageEmotes),r.username=a.username,r["message-type"]=a.messageType,r}const p={version:()=>"2.0.0",latency:()=>i?i.latency:-1,getInstance:()=>i,onConnected:(a,r,s)=>{i&&i.debug&&console.debug("onConnected default handler")},onReconnect:a=>{i&&i.debug&&console.debug("onReconnect default handler")},onError:a=>{console.error("Error:",a)},onCommand:(a,r,s,o,t)=>{i&&i.debug&&console.debug("onCommand default handler")},onChat:(a,r,s,o,t)=>{i&&i.debug&&console.debug("onChat default handler")},onCheer:(a,r,s,o,t)=>{i&&i.debug&&console.debug("onCheer default handler")},onWhisper:(a,r,s,o,t)=>{i&&i.debug&&console.debug("onWhisper default handler")},onSub:(a,r,s,o)=>{i&&i.debug&&console.debug("onSub default handler")},onResub:(a,r,s,o,t,e)=>{i&&i.debug&&console.debug("onResub default handler")},onSubGift:(a,r,s,o,t,e)=>{i&&i.debug&&console.debug("onSubGift default handler")},onSubMysteryGift:(a,r,s,o,t)=>{i&&i.debug&&console.debug("onSubMysteryGift default handler")},onGiftSubContinue:(a,r,s)=>{i&&i.debug&&console.debug("onGiftSubContinue default handler")},onTimeout:(a,r,s)=>{i&&i.debug&&console.debug("onTimeout default handler")},onBan:(a,r)=>{i&&i.debug&&console.debug("onBan default handler")},onMessageDeleted:(a,r)=>{i&&i.debug&&console.debug("onMessageDeleted default handler")},onRaid:(a,r,s)=>{i&&i.debug&&console.debug("onRaid default handler")},onUnraid:(a,r)=>{i&&i.debug&&console.debug("onUnraid default handler")},simulateIRCMessage:a=>{i&&i.simulateIRCMessage(a)},Init:(a,r,s,o)=>{i=new Ta(a,r,s,o),i.on(d.Connect,t=>{p.onConnected(t.address,t.port,t.isFirstConnect)}),i.on(d.Reconnect,t=>{console.log("RECONNECT"),p.onReconnect(t.reconnectCount)}),i.on(d.Error,t=>{p.onError(t)}),i.on(d.Command,t=>{var e;p.onCommand(t.displayName||t.username,t.command,t.message,t.flags,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Chat,t=>{var e;p.onChat(t.displayName||t.username,t.message,t.flags,t.self,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Whisper,t=>{var e;p.onWhisper(t.displayName||t.username,t.message,t.flags,t.self,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,channel:t.username,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Cheer,t=>{var e;p.onCheer(t.displayName||t.username,t.message,t.bits,t.flags,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Subscribe,t=>{var e;p.onSub(t.displayName||t.username,t.message,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Resubscribe,t=>{var e;p.onResub(t.displayName||t.username,t.message,t.streakMonths||0,t.cumulativeMonths,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.SubGift,t=>{var e;p.onSubGift(t.displayName||t.username,t.streakMonths||0,t.recipientDisplayName,t.senderCount,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.MysterySubGift,t=>{var e;p.onSubMysteryGift(t.displayName||t.username,t.giftCount,t.senderCount,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes),userMassGiftCount:t.giftCount})}),i.on(d.SubGiftContinue,t=>{var e;p.onGiftSubContinue(t.displayName||t.username,t.gifterDisplayName,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Timeout,t=>{var e;p.onTimeout(t.displayName||t.username,t.duration,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes),timedOutUserId:t.userId})}),i.on(d.Ban,t=>{var e;p.onBan(t.displayName||t.username,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes),bannedUserId:t.userId})}),i.on(d.MessageDeleted,t=>{var e;p.onMessageDeleted(t.id,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Raid,t=>{var e;p.onRaid(t.displayName||t.username,t.viewers,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})}),i.on(d.Unraid,t=>{var e;p.onUnraid(t.channel,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:f(t.messageEmotes)})})}};typeof module<"u"&&module.exports&&(module.exports=p);typeof window<"u"&&(window.ComfyJSNew=p);
//# sourceMappingURL=comfy.min.js.map
